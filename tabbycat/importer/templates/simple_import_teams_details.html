{% extends "base.html" %}
{% load static debate_tags add_field_css i18n %}

{% block head-title %}<span class="emoji">ðŸ‘¯</span>{% trans 'Add Teams' context 'page title' %}
{% blocktrans trimmed with step=wizard.steps.step1 count=wizard.steps.count %}(Step {{ step }} of {{ count }}){% endblocktrans %}{% endblock %}
{% block page-title %}ðŸ‘¯ {% trans 'Add Teams' context 'page title' %}{% endblock %}

{% block content %}

<form method="POST">
  {% csrf_token %}
  {{ wizard.management_form }}
  {{ wizard.form.management_form }}

  <div class="row">
    <div class=" col-md-12 ">
      <button type="submit" class="btn btn-outline-primary" name="wizard_goto_step" value="{{ wizard.steps.prev }}"><i data-feather="chevron-left"></i>{% trans "Previous Step" %}</button>
    </div>
  </div>

  {% if wizard.form.errors %}
  <div class="alert alert-danger">
    <i data-feather="alert-circle"></i>
    <p>{% trans "There are some problems with the data on this form:" %}</p>
    {{ wizard.form.non_form_errors }}
  </div>
  {% endif %}

  {% regroup wizard.form.forms by institution_for_display as forms_by_institution %}

  {% for forms in forms_by_institution %}

    <div class="card mt-3">
      <div class="list-group list-group-flush pb-1">

        <div class="list-group-item card-title pb-1">
          <h4>{% blocktrans trimmed with institution_name=forms.grouper.name %}
            Teams for {{ institution_name }}
          {% endblocktrans %}</h4>
        </div>

        {% for form in forms.list %}
          <div class="list-group-item pb-4">

              {% if form.non_field_errors %}
                <div class="col-sm-12">
                  {{ form.non_field_errors }}
                </div>
              {% endif %}

              {% for field in form.hidden_fields %}
                {{ field }}
              {% endfor %}

              {% for field in form.visible_fields %}
                <div class="form-group">
                  <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                  {{ field|addcss:"form-control" }}
                  {{ field.errors }}
                </div>
              {% endfor %}

          </div>
        {% endfor %}

      </div>
    </div>

  {% endfor %}

  <div class="row mt-3">
    <div class="col-md-12">
      <input type="submit" class="btn btn-block btn-success" value="{% trans 'Save All Teams' %}" />
    </div>
  </div>

</form>

{% endblock content %}
